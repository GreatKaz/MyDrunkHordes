<!doctype html>
<html lang="fr">
<head>
  <link rel="icon" href="favicon.ico">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MyDrunkHordes</title>
  <style>
    :root { color-scheme: dark light; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      margin: 0; padding: 24px;
      background: #0b0f14;
      color: #e8eef7;
    }
    .wrap { max-width: 900px; margin: 0 auto; }
    h1 { font-size: 20px; margin: 0 0 16px; font-weight: 700; }
    .card {
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 14px;
      padding: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    }
    textarea {
      width: 100%;
      min-height: 140px;
      resize: vertical;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.15);
      background: rgba(0,0,0,0.25);
      color: #e8eef7;
      outline: none;
      line-height: 1.4;
      font-size: 14px;
      box-sizing: border-box;
    }
    textarea:focus { border-color: rgba(112, 168, 255, 0.7); }
    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 14px;
      margin-top: 14px;
    }
    @media (min-width: 840px) {
      .grid { grid-template-columns: 1.15fr 0.85fr; }
    }
    .section-title { font-size: 13px; opacity: 0.9; margin: 0 0 8px; }
    .lists {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .check {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.18);
      user-select: none;
    }
    .check input { transform: scale(1.1); }
    .controls {
      display: flex;
      flex-direction: column;
      gap: 12px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.18);
    }
    .slider-row { display: flex; align-items: center; justify-content: space-between; gap: 12px; }
    input[type="range"] { width: 100%; }
    .pill {
      display: inline-flex;
      align-items: center;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.25);
      font-size: 12px;
      white-space: nowrap;
    }
    button {
      cursor: pointer;
      border: 0;
      padding: 12px 14px;
      border-radius: 12px;
      font-weight: 700;
      background: linear-gradient(135deg, #5fb0ff, #8a5bff);
      color: #0b0f14;
    }
    button:hover { filter: brightness(1.05); }
    .row { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    .muted { opacity: 0.8; font-size: 12px; }
    .footer {
      margin-top: 14px;
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .smallbtn {
      background: rgba(255,255,255,0.10);
      color: #e8eef7;
      border: 1px solid rgba(255,255,255,0.16);
      font-weight: 600;
    }
    .output {
  min-height: 140px;
  padding: 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.15);
  background: rgba(0,0,0,0.25);
  color: #e8eef7;
  line-height: 1.4;
  font-size: 14px;
  white-space: pre-wrap;
}

.output em {
  font-style: italic;
  opacity: 0.85;
}

    .smallbtn:hover { filter: brightness(1.25); }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Transformateur de texte MyDrunkHordes</h1>

    <div class="card">
      <p class="section-title">Texte d‚Äôentr√©e</p>
      <textarea id="inputText" placeholder="Colle/√©cris ton texte ici..."></textarea>

      <div class="grid">
        <div>
          <p class="section-title">Listes utilis√©es (6)</p>
          <div class="lists" id="listsBox"></div>
        </div>

        <div class="controls">
          <div>
            <p class="section-title">Intensit√©</p>
            <div class="slider-row">
              <span class="pill">l√©ger</span>
              <input id="intensity" type="range" min="0" max="2" step="1" value="1" />
              <span class="pill">d√©truit</span>
            </div>
            <div class="row">
              <span class="muted">S√©lection :</span>
              <span id="intensityLabel" class="pill">moyen</span>
            </div>
          </div>

          <button id="transformBtn">Transformer</button>

        <div class="footer">
            <button id="copyBtn" class="smallbtn" type="button">Copier le r√©sultat</button>
            <button id="copyForumBtn" class="smallbtn" type="button">Copier (forum)</button>
            <span class="muted" id="toast"></span>
        </div>

      </div>
    </div>

      <p class="section-title" style="margin-top:14px;">Texte transform√©</p>
      <div id="outputText" class="output" aria-readonly="true"></div>
    </div>
  </div>

  <script>
    // ==============
    // 1) TES 6 LISTES
    // ==============
    // Modifie librement : ajoute/retire des mots, change les th√®mes, etc.
const WORD_LISTS = [
  {
    id: "liste1",
    label: "Douleur",
    words: [
      "...ggh..",
      "tousse...",
      "...argh..",
      "..gnn..",
      "... je...",
      ".g...",
      "grogne...",
      "..Gn..",
      "..raah..",
      "....",
      "RAAH !..",
      "..le...",
      "qu.. non..."
    ]
  },
  {
    id: "liste2",
    label: "Folie",
    words: [
      ".. AH AH AH !...",
      "..vais tous vous...",
      "..les.. voix...",
      ".gghhh...",
      "NOOOoon !...",
      "marmonne...",
      "..hin hin...",
      "ALLEZ VOUS EN !..",
      "des araign√©es...",
      "..ils sont partout...",
      "..Lachez moi !..",
      ".. Ah... Ah ah..",
      ".. qui est l√† ?..",
      "..rrRRR... RAAAAaah !",
      ".r.tuer...",
      "...ricane..",
      "...",
      "..Petiiit papaa Noo.. NOOOON !!...",
      "et pirouette cacahu√®tes ...",
      "..hein ?",
      "..froid..",
      "..ou bien...",
      ".. Qu'est-ce que...",
      "non ?.. Oui ?",
      ". Pas du tout..",
      ".. Laissez moi !",
      "..Hi hi hi ! ...",
      "grogne...",
      "... Mon beau sapiiin ! ....",
      ".. roule petit patapon ...",
      "... toujours un beau temps au nord ...",
      ".. Alouetteuuh gentiiil.. Hein ?..",
      "car il y a longtemps que je t'aime...",
      "mon ami Pierroooot",
      "et ainsi font font FONT !! Ah !..."
    ]
  },
  {
    id: "liste3",
    label: "Saoul",
    words: [
      "... ouais...",
      "et euuh..",
      "...",
      ".. et je...",
      "non...",
      "... pis..",
      ".. non attend..",
      "et euh... l√†",
      ".. pis alors...",
      "non ?.. Oui ?",
      "..Hi hi hi ! ...",
      "... j'crois...",
      ".gghhh...",
      "..hin hin...",
      "..H√© h√©...",
      "..hein ?",
      "..ou bien...",
      ".. Qu'est-ce que...",
      "non ?.. Oui ?",
      "... ou pas quoi...",
      ".. enfin.. tu vois quoi...",
      ".. ouais les gars...",
      "voil√† quoi...",
      ".. et euh... j'disais quoi...",
      "... parceque tu vois...",
      "...",
      "genre...",
      "style...",
      "et paf...",
      "mais... euh..",
      "* HIPS *...",
      "... comment d√©j√†...",
      "arf.",
      "... truc..",
      "pfff...",
      "...",
      "...",
      "...",
      "..",
      "..",
      "... ..."
    ]
  },
  {
    id: "liste4",
    label: "Mots al√©atoires",
    words: [
      "zombie",
      "cadavre",
      "souffrances",
      "atroce",
      "pourriture",
      "infection",
      "putride",
      "fant√¥me",
      "horrible",
      "immonde",
      "monstre",
      "tomate",
      "poire",
      "banane",
      "pomme",
      "tulipe",
      "peur",
      "avion",
      "p√©pin",
      "rigolo",
      "fleur",
      "youpi-banane",
      "avion",
      "polompolom",
      "sapine",
      "galinac√©e",
      "canard",
      "biloute",
      "berlingot",
      "patate",
      "gourde",
      "carotte",
      "sapin",
      "papa No√´l",
      "pelle",
      "pouic",
      "schtroumpfer",
      "folie",
      "abeille",
      "patapon",
      "lalala",
      "manger",
      "d√©vorer",
      "broyer"
    ]
  },
  {
    id: "liste5",
    label: "Saoul++",
    words: [
      "... le...",
      "et euuh..",
      ".. et je...",
      ".. non...",
      "... pis..",
      ".. non attend..",
      "et euh... l√†",
      ".. pis alors...",
      "... j'crois...",
      ".t..T..Truc...",
      "... la...",
      "..hein ?..",
      "..tu vois...",
      "..ou bien...",
      ".. un euh...",
      ".. non ?.. hein ?",
      "... ou pas...",
      ".. enfin.. tu vois quoi...",
      ".. bidule...",
      ".. voil√† quoi...",
      ".. et euh... j'disais quoi...",
      "... parceque tu vois...",
      "genre...",
      "style...",
      ".. raaah bordel...",
      ".. mais... euh..",
      "HIPS...",
      "... comment d√©j√†...",
      "arf.",
      "... machin..",
      "... le bazar l√†..",
      ".. le truc l√†...",
      "... truc..",
      ".. genre...",
      ".. r√¥te...",
      ".. bordel..",
      "euh...",
      "huh...",
      "..le bazar quoi...",
      "... parceque.."
    ]
  },
    {
    id: "liste6",
    label: "Graines d'Opti",
    words: [
      "c'est la faute √†... Botaire..",
      "Mnemeoooo",
      "trop.. Hips.. mignon le Kiki",
    ]
  }
];

    // ==================================
    // 2) REMPLACEMENTS (mots -> autres)
    // ==================================
    // Id√©e : certains mots du texte original doivent √™tre remplac√©s.
    // La cl√© est en minuscule ; le remplacement sera adapt√© √† la casse.
    const REPLACEMENTS = {
      "je": "moi",
      "tu": "toi",
      "nous": "nous autres",
      "vous": "vous l√†",
      "oui": "ouais",
      "non": "nan",
      "bonjour": "salut",
      "merci": "thx",
      "d√©sol√©": "pardon",
      "vraiment": "genre",
      "tr√®s": "m√©ga",
      "petit": "mini",
      "grand": "√©norme",
      "cool": "styl√©",
      "bien": "ok",
      "mal": "pas ouf"
    };

    // =========================
    // 3) PARAM√àTRES D'INTENSIT√â
    // =========================
    // Plus l'intensit√© est haute :
    // - plus on remplace de mots
    // - plus on ins√®re des mots/expressions
    // - plus on ‚Äúab√Æme‚Äù l√©g√®rement la ponctuation
    const INTENSITY_PRESETS = [
     { name: "l√©ger",   replaceRate: 0.08, insertPerSentence: [0, 1], sprinklePunct: 0.06 },
     { name: "moyen",   replaceRate: 0.18, insertPerSentence: [2, 4], sprinklePunct: 0.12 },
     { name: "d√©truit", replaceRate: 0.35, insertPerSentence: [3, 5], sprinklePunct: 0.22 }
    ];


    // ============
    // UI BUILD
    // ============
    const listsBox = document.getElementById("listsBox");
    const intensity = document.getElementById("intensity");
    const intensityLabel = document.getElementById("intensityLabel");
    const inputText = document.getElementById("inputText");
    const outputText = document.getElementById("outputText");
    const toast = document.getElementById("toast");

    function buildListsUI() {
      listsBox.innerHTML = "";
      WORD_LISTS.forEach((l, idx) => {
        const wrap = document.createElement("label");
        wrap.className = "check";
        const cb = document.createElement("input");
        cb.type = "checkbox";
        cb.checked = true;
        cb.id = l.id;

        const span = document.createElement("span");
        span.textContent = l.label;

        wrap.appendChild(cb);
        wrap.appendChild(span);
        listsBox.appendChild(wrap);
      });
    }

    function updateIntensityLabel() {
      const preset = INTENSITY_PRESETS[Number(intensity.value)];
      intensityLabel.textContent = preset.name;
    }

    buildListsUI();
    updateIntensityLabel();
    intensity.addEventListener("input", updateIntensityLabel);

    // ============
    // HELPERS
    // ============
    function randInt(min, max) { // inclusive
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    function escapeHTML(str) {
     return str
    .replaceAll("&", "&amp;")
    .replaceAll("<", "&lt;")
    .replaceAll(">", "&gt;");
    }

    function pick(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function enabledWordPool() {
      const pool = [];
      WORD_LISTS.forEach(l => {
        const cb = document.getElementById(l.id);
        if (cb && cb.checked) pool.push(...l.words);
      });
      return pool;
    }

    function splitSentences(text) {
      // Coupe de mani√®re simple tout en gardant le s√©parateur
      // Exemple: ["Salut", "!", " Comment √ßa va", "?", ...]
      const parts = text.split(/([.!?]+|\n+)/g);
      // Recombine en segments ‚Äúphrase + s√©parateur‚Äù
      const out = [];
      for (let i = 0; i < parts.length; i += 2) {
        const chunk = (parts[i] ?? "");
        const sep = (parts[i+1] ?? "");
        out.push(chunk + sep);
      }
      return out.filter(s => s.length > 0);
    }

    function tokenize(text) {
      // Tokenisation l√©g√®re : mots / espaces / ponctuation
      // Permet de remplacer des "mots" en gardant la ponctuation.
      return text.match(/<\/?em>|[\p{L}\p{N}‚Äô']+|\s+|[^\s\p{L}\p{N}]+/gu) || [];
    }

    function applyCaseLike(source, target) {
      // Adapte un remplacement √† la casse du mot original.
      if (source.toUpperCase() === source) return target.toUpperCase();
      if (source[0] && source[0].toUpperCase() === source[0]) {
        return target.charAt(0).toUpperCase() + target.slice(1);
      }
      return target;
    }

    function maybeReplaceToken(tok, replaceRate, pool) {
     // On ne touche qu'aux vrais mots
     if (!/^[\p{L}\p{N}‚Äô']+$/u.test(tok)) return tok;

     if (Math.random() > replaceRate) return tok;
     if (!pool || pool.length === 0) return tok;

     // On √©vite de remplacer des mots trop courts (lisibilit√©)
     if (tok.length <= 2) return tok;

     const replacement = pick(pool);

     return `<em>${escapeHTML(applyCaseLike(tok, replacement))}</em>`;
    }


    function sprinkleExtraPunct(text, chance) {
      // Ajoute parfois un tic de ponctuation en fin de segment
      if (Math.random() > chance) return text;
      const tics = ["...", "!!", "?!", "‚Äî"];
      const tic = pick(tics);
      // √âvite d‚Äôempiler 300 fois
      if (text.trim().endsWith(tic)) return text;
      return text.replace(/\s*$/, "") + " " + tic + " ";
    }
    function flash(btn, msg = "Copi√© ‚úÖ") {
    const old = btn.textContent;
    btn.textContent = msg;
    btn.disabled = true;
    setTimeout(() => {
        btn.textContent = old;
        btn.disabled = false;
    }, 900);
    }

    function copyToClipboard(text) {
    // Clipboard API si dispo, sinon fallback textarea
    if (navigator.clipboard && window.isSecureContext) {
        return navigator.clipboard.writeText(text);
    }
    return new Promise((resolve, reject) => {
        try {
        const ta = document.createElement("textarea");
        ta.value = text;
        ta.setAttribute("readonly", "");
        ta.style.position = "fixed";
        ta.style.left = "-9999px";
        document.body.appendChild(ta);
        ta.select();
        const ok = document.execCommand("copy");
        document.body.removeChild(ta);
        ok ? resolve() : reject(new Error("copy failed"));
        } catch (e) {
        reject(e);
        }
    });
    }

    // Convertit le contenu HTML (avec <em>) en BBCode [i][/i]
    function outputToBBCode() {
    // On reconstruit depuis le DOM pour r√©cup√©rer le texte "d√©cod√©"
    const root = outputText.cloneNode(true);

    function walk(node) {
        if (node.nodeType === Node.TEXT_NODE) return node.nodeValue;
        if (node.nodeType !== Node.ELEMENT_NODE) return "";

        const tag = node.tagName.toLowerCase();

        if (tag === "em") {
        let inside = "";
        node.childNodes.forEach(ch => inside += walk(ch));
        return `[i]${inside}[/i]`;
        }
        if (tag === "br") return "\n";

        let out = "";
        node.childNodes.forEach(ch => out += walk(ch));
        return out;
    }

    let result = "";
    root.childNodes.forEach(ch => result += walk(ch));
    return result;
    }

    function insertRandomWords(segment, pool, minMax) {
  if (pool.length === 0) return segment;
  const [minIns, maxIns] = minMax;
  const count = randInt(minIns, maxIns);
  if (count <= 0) return segment;

  let out = segment;

  for (let i = 0; i < count; i++) {
    const w = pick(pool);

    const tokens = tokenize(out);

    // Positions d'insertion autoris√©es : seulement hors des zones <em>...</em>
    const insertPositions = [];
    let inEm = false;

    // position "0" = avant le 1er token
    if (!inEm) insertPositions.push(0);

    for (let k = 0; k < tokens.length; k++) {
      const t = tokens[k];
      if (t === "<em>") inEm = true;
      if (t === "</em>") inEm = false;

      // position k+1 = entre tokens[k] et tokens[k+1]
      if (!inEm) insertPositions.push(k + 1);
    }

    if (insertPositions.length === 0) return out;

    const pos = pick(insertPositions);
    const safeWord = `<em>${escapeHTML(w)}</em>`; // (bonus s√©curit√©)

    tokens.splice(pos, 0, (pos === 0 ? "" : " ") + safeWord + " ");
    out = tokens.join("").replace(/\s{2,}/g, " ");
  }

  return out;
}


    // ============
    // MAIN TRANSFORM
    // ============
    function transformText(text) {
      text = escapeHTML(text);
      const preset = INTENSITY_PRESETS[Number(intensity.value)];
      const pool = enabledWordPool();

      const segments = splitSentences(text);
      let replacedCount = 0;
      let insertedCount = 0;

      const transformed = segments.map(seg => {
        // 1) remplacement mot √† mot
        const toks = tokenize(seg).map(tok => {
          const before = tok;
          const after = maybeReplaceToken(tok, preset.replaceRate, pool);
          if (after !== before) replacedCount++;
          return after;
        });

        let rebuilt = toks.join("");

        // 2) insertion de mots pioch√©s dans les listes activ√©es
        const beforeInsert = rebuilt;
        rebuilt = insertRandomWords(rebuilt, pool, preset.insertPerSentence);
        if (rebuilt !== beforeInsert) {
          // estimation : pas exact mais utile
          insertedCount += 1;
        }

        // 3) ponctuation parasite l√©g√®re
        rebuilt = sprinkleExtraPunct(rebuilt, preset.sprinklePunct);

        return rebuilt;
      }).join("");

      return { text: transformed.replace(/\s{2,}/g, " ").trim(), replacedCount, insertedCount };
    }

    // ============
    // BUTTONS
    // ============
    document.getElementById("transformBtn").addEventListener("click", () => {
      const src = inputText.value || "";
      if (!src.trim()) {
         outputText.innerHTML = "";
         toast.textContent = "Entre du texte üôÇ";
      return;
    }

      const res = transformText(src);
      outputText.innerHTML = res.text;
      toast.textContent = "Transform√© ‚úÖ";
    });

    document.getElementById("copyBtn").addEventListener("click", async () => {
  const plain = outputText.innerText || "";
  if (!plain.trim()) return;

  const btn = document.getElementById("copyBtn");
  try {
    await copyToClipboard(plain);
    toast.textContent = "Copie normale OK ‚úÖ";
    flash(btn);
  } catch {
    toast.textContent = "Copie impossible ‚ùå (navigateur/HTTPS)";
  } finally {
    setTimeout(() => toast.textContent = "", 1400);
  }
});

document.getElementById("copyForumBtn").addEventListener("click", async () => {
  const bb = outputToBBCode();
  if (!bb.trim()) return;

  const btn = document.getElementById("copyForumBtn");
  try {
    await copyToClipboard(bb);
    toast.textContent = "Copie forum (BBCode) OK ‚úÖ";
    flash(btn);
  } catch {
    toast.textContent = "Copie impossible ‚ùå (navigateur/HTTPS)";
  } finally {
    setTimeout(() => toast.textContent = "", 1400);
  }
});
  </script>
</body>
</html>
